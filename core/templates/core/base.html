{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{% block title %}HospedAI{% endblock %}</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
  * { margin:0; padding:0; box-sizing:border-box; font-family: 'Inter', sans-serif; transition: all 0.3s ease; }
  body { background:#f4f6fa; color:#1a1a1a; scroll-behavior: smooth; overflow-x:hidden; }
  body.dark { background:#0d1117; color:#e0e0e0; }

  /* Particles Background */
  #particles { position:fixed; top:0; left:0; width:100%; height:100%; z-index:-2; }

  /* Topbar futurista */
  header {
    display:flex; justify-content:space-between; align-items:center; padding:20px 50px;
    background:rgba(255,255,255,0.3); backdrop-filter:blur(12px);
    position:sticky; top:0; z-index:100; border-bottom:1px solid rgba(79,70,229,0.3);
    box-shadow:0 0 20px rgba(79,70,229,0.2); overflow:hidden;
  }

  /* Logo */
  .logo { display:flex; align-items:center; font-size:26px; font-weight:700; color:#4f46e5; cursor:pointer; }
  .logo img { height:35px; margin-right:5px; vertical-align:middle; }

  nav { display:flex; align-items:center; }
  nav a {
    margin-left:25px; text-decoration:none; color:#000; font-weight:500; position:relative;
    transition:0.3s; font-size:16px;
  }
  nav a::after {
    content:''; position:absolute; width:0; height:2px; background:#4f46e5; bottom:-4px; left:0; transition:0.3s; box-shadow:0 0 6px #4f46e5;
  }
  nav a:hover::after { width:100%; }
  nav a:hover { transform:translateY(-2px); color:#4f46e5; }

  .dark-toggle { margin-left:20px; cursor:pointer; font-weight:600; color:#4f46e5; }

  /* User dropdown */
  .user-menu { position:relative; margin-left:20px; }
  .user-menu button {
    background:none; border:none; color:#000; font-weight:600;
    cursor:pointer; display:flex; align-items:center; gap:6px;
  }
  .user-menu-content {
    display:none; position:absolute; right:0; top:100%; background:#fff;
    border-radius:10px; overflow:hidden; box-shadow:0 5px 20px rgba(79,70,229,0.5);
  }
  .user-menu-content a, .user-menu-content form button {
    display:block; padding:10px 15px; color:#000; text-align:left; background:none; border:none; cursor:pointer; width:100%;
  }
  .user-menu-content a:hover, .user-menu-content form button:hover { background:rgba(79,70,229,0.2); }
  .user-menu:hover .user-menu-content { display:block; }

  /* Topbar particles */
  #topbar-particles { position:absolute; top:0; left:0; width:100%; height:100%; z-index:-1; pointer-events:none; }

  main { padding:20px; min-height:80vh; }
  footer { text-align:center; padding:30px; font-size:14px; color:#888; }
</style>
</head>
<body id="body" class="light">

<canvas id="particles"></canvas>
<header>
  <div class="logo" onclick="location.href='{% url 'home' %}'">
      <img src="{% static 'core/img/logo-black-removebg-preview.png' %}" alt="Logo">
      HospedAI
  </div>
  <nav>
    <a href="{% url 'home' %}">Home</a>
    <a href="{% url 'criar_quarto' %}">Criar Quarto</a>
    <a href="{% url 'listar_quartos' %}">Quartos</a>
    <a href="{% url 'nova_reserva' %}">Reservas</a>
    <a href="{% url 'calendario_quartos' %}">CalendÃ¡rio</a>
    {% if request.user.is_authenticated %}
      <div class="user-menu">
        <button><i class="fas fa-user-circle"></i> {{ request.user.username }} <i class="fas fa-caret-down"></i></button>
        <div class="user-menu-content">
          <a href="{% url 'profile' %}"><i class="fas fa-id-badge"></i> Perfil</a>
          <form method="post" action="{% url 'logout' %}">{% csrf_token %}<button type="submit"><i class="fas fa-sign-out-alt"></i> Logout</button></form>
        </div>
      </div>
    {% else %}
      <a href="{% url 'login' %}">Login</a>
    {% endif %}
    <span class="dark-toggle" onclick="toggleDark()">ðŸŒ™</span>
  </nav>
  <canvas id="topbar-particles"></canvas>
</header>

<main>
    {% if messages %}
    <div class="messages">
        {% for message in messages %}
            <div class="{% if message.tags %}{{ message.tags }}{% endif %}">
                {{ message }}
            </div>
        {% endfor %}
    </div>
    {% endif %}
    {% block content %}{% endblock %}
</main>

<footer>Â© {% now "Y" %} HospedAI - Todos os direitos reservados.</footer>

<script>
  // Dark mode toggle
function toggleDark() {
    const body = document.getElementById('body');
    body.classList.toggle('dark-mode'); // agora bate com o CSS
}


  // Particles Background
  const canvas = document.getElementById('particles');
  const ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth; canvas.height = window.innerHeight;
  const particles = [];
  for(let i=0;i<120;i++){
    particles.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,r:Math.random()*2+1,speedX:(Math.random()-0.5)/1.5,speedY:(Math.random()-0.5)/1.5});
  }
  function animate(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    for(let p of particles){
      p.x+=p.speedX; p.y+=p.speedY;
      if(p.x>canvas.width)p.x=0;if(p.x<0)p.x=canvas.width;
      if(p.y>canvas.height)p.y=0;if(p.y<0)p.y=canvas.height;
      ctx.beginPath();ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
      ctx.fillStyle='rgba(79,70,229,0.7)';ctx.fill();ctx.closePath();
    }
    for(let i=0;i<particles.length;i++){
      for(let j=i+1;j<particles.length;j++){
        let dx=particles[i].x-particles[j].x;
        let dy=particles[i].y-particles[j].y;
        let dist=Math.sqrt(dx*dx+dy*dy);
        if(dist<120){
          ctx.beginPath();
          ctx.strokeStyle='rgba(79,70,229,'+(1-dist/120)+')';
          ctx.lineWidth=1;
          ctx.moveTo(particles[i].x,particles[i].y);
          ctx.lineTo(particles[j].x,particles[j].y);
          ctx.stroke();
          ctx.closePath();
        }
      }
    }
    requestAnimationFrame(animate);
  }
  animate();
  window.addEventListener('resize',()=>{canvas.width=window.innerWidth; canvas.height=window.innerHeight;});

  // Topbar micro particles
  const topbarCanvas = document.getElementById('topbar-particles');
  const topCtx = topbarCanvas.getContext('2d');
  topbarCanvas.width = window.innerWidth; topbarCanvas.height = 70;
  const topParticles = [];
  for(let i=0;i<40;i++){
    topParticles.push({x:Math.random()*topbarCanvas.width,y:Math.random()*topbarCanvas.height,r:Math.random()*1.5+0.5,speedX:(Math.random()-0.5)/1.5});
  }
  function animateTop(){
    topCtx.clearRect(0,0,topbarCanvas.width,topbarCanvas.height);
    for(let p of topParticles){
      p.x+=p.speedX;
      if(p.x>topbarCanvas.width)p.x=0;
      if(p.x<0)p.x=topbarCanvas.width;
      topCtx.beginPath();
      topCtx.arc(p.x,p.y,p.r,0,Math.PI*2);
      topCtx.fillStyle='rgba(79,70,229,0.6)';
      topCtx.shadowBlur=10;topCtx.shadowColor="#4f46e5";
      topCtx.fill();topCtx.closePath();
    }
    requestAnimationFrame(animateTop);
  }
  animateTop();
  window.addEventListener('resize',()=>{topbarCanvas.width=window.innerWidth; topbarCanvas.height=70;});
</script>

</body>
</html>
